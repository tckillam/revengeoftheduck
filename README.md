Requirements 1, 4 and 5 are done.
3 is basically done but can be cleaned up.
Requirement 2 has not been attempted.
